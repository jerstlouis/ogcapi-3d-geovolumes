= (???)
:stem:

*Open Geospatial Consortium*

Submission Date: \<yyyy-mm-dd\>

Approval Date:&nbsp;&nbsp;&nbsp;\<yyyy-mm-dd\>

Publication Date:&nbsp;&nbsp;&nbsp;\<yyyy-mm-dd\>

[[Cover_RemoveText2]]External identifier of this OGC^®^ document: \< http://www.opengis.net/def/%5B%7Bdoc-type/%7D%5D%7Bstandard%7D/%7Bm.n%7D[http://www.opengis.net/doc/[{doc-type/}]{standard}/{m.n}]\>

Internal reference number of this OGC^®^ document:&nbsp;&nbsp;&nbsp;&nbsp;YY-nnnrx

Version: 0.0.1

Category: OGC^®^ Draft Candidate Specification

Editors:&nbsp;&nbsp;&nbsp;Jeff Harrison, Ignacio Correas,Jerome Jacovella-St-Louis

+
 +

+
 +

+
 +

OGC API - 3D GeoVolumes

+
 +

+
 +

*Copyright Notice*

Copyright © 2022 Open Geospatial Consortium +
 To obtain additional rights of use, visit http://www.opengeospatial.org/legal/[http://www.opengeospatial.org/legal/].

+
 +

*Warning*

This document is not an OGC Standard. This document is distributed for review and comment. This document is subject to change without notice and may not be referred to as an OGC Standard.

Document type:&nbsp;&nbsp;&nbsp; OGC^®^Draft Candidate Specification

Document subtype:&nbsp;&nbsp;&nbsp; If Applicable

Document stage:&nbsp;&nbsp;&nbsp; Draft

Document language:&nbsp; English

Recipients of this document are invited to submit, with their comments, notification of any relevant patent rights of which they are aware and to provide supporting documentation.

License Agreement

Permission is hereby granted by the Open Geospatial Consortium, ("Licensor"), free of charge and subject to the terms set forth below, to any person obtaining a copy of this Intellectual Property and any associated documentation, to deal in the Intellectual Property without restriction (except as set forth below), including without limitation the rights to implement, use, copy, modify, merge, publish, distribute, and/or sublicense copies of the Intellectual Property, and to permit persons to whom the Intellectual Property is furnished to do so, provided that all copyright notices on the intellectual property are retained intact and that each person to whom the Intellectual Property is furnished agrees to the terms of this Agreement.

If you modify the Intellectual Property, all copies of the modified Intellectual Property must include, in addition to the above copyright notice, a notice that the Intellectual Property includes modifications that have not been approved or adopted by LICENSOR.

THIS LICENSE IS A COPYRIGHT LICENSE ONLY, AND DOES NOT CONVEY ANY RIGHTS UNDER ANY PATENTS THAT MAY BE IN FORCE ANYWHERE IN THE WORLD.

THE INTELLECTUAL PROPERTY IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS. THE COPYRIGHT HOLDER OR HOLDERS INCLUDED IN THIS NOTICE DO NOT WARRANT THAT THE FUNCTIONS CONTAINED IN THE INTELLECTUAL PROPERTY WILL MEET YOUR REQUIREMENTS OR THAT THE OPERATION OF THE INTELLECTUAL PROPERTY WILL BE UNINTERRUPTED OR ERROR FREE. ANY USE OF THE INTELLECTUAL PROPERTY SHALL BE MADE ENTIRELY AT THE USER'S OWN RISK. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR ANY CONTRIBUTOR OF INTELLECTUAL PROPERTY RIGHTS TO THE INTELLECTUAL PROPERTY BE LIABLE FOR ANY CLAIM, OR ANY DIRECT, SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES, OR ANY DAMAGES WHATSOEVER RESULTING FROM ANY ALLEGED INFRINGEMENT OR ANY LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR UNDER ANY OTHER LEGAL THEORY, ARISING OUT OF OR IN CONNECTION WITH THE IMPLEMENTATION, USE, COMMERCIALIZATION OR PERFORMANCE OF THIS INTELLECTUAL PROPERTY.

This license is effective until terminated. You may terminate it at any time by destroying the Intellectual Property together with all copies in any form. The license will also terminate if you fail to comply with any term or condition of this Agreement. Except as provided in the following sentence, no such termination of this license shall require the termination of any third party end-user sublicense to the Intellectual Property which is in force as of the date of notice of such termination. In addition, should the Intellectual Property, or the operation of the Intellectual Property, infringe, or in LICENSOR's sole opinion be likely to infringe, any patent, copyright, trademark or other right of a third party, you agree that LICENSOR, in its sole discretion, may terminate this license without any compensation or liability to you, your licensees or any other party. You agree upon termination of any kind to destroy or cause to be destroyed the Intellectual Property together with all copies in any form, whether held by you or by any third party.

Except as contained in this notice, the name of LICENSOR or of any other holder of a copyright in all or part of the Intellectual Property shall not be used in advertising or otherwise to promote the sale, use or other dealings in this Intellectual Property without prior written authorization of LICENSOR or such copyright holder. LICENSOR is and shall at all times be the sole entity that may authorize you or any third party to use certification marks, trademarks or other special designations to indicate compliance with any LICENSOR standards or specifications. This Agreement is governed by the laws of the Commonwealth of Massachusetts. The application to this Agreement of the United Nations Convention on Contracts for the International Sale of Goods is hereby expressly excluded. In the event any provision of this Agreement shall be deemed unenforceable, void or invalid, such provision shall be modified so as to make it valid and enforceable, and as so modified the entire Agreement shall remain in full force and effect. No decision, action or inaction by LICENSOR shall be construed to be a waiver of any rights or remedies available to it.

+
 +

== Contents

+
 +

[[Table of Contents1]]

<<_Toc92639049,1.Scope 7>>

<<_Toc92639050,1.1Why 3D GeoVolumes? 8>>

<<_Toc92639051,1.2What are 3D GeoVolumes? 10>>

<<_Toc92639052,2.Conformance 14>>

<<_Toc92639053,2.1Mandatory Requirements Classes 14>>

<<_Toc92639054,2.2Optional Requirements Classes 15>>

<<_Toc92639055,3.References 15>>

<<_Toc92639056,4.Terms and Definitions 16>>

<<_Toc92639057,5.Conventions 17>>

<<_Toc92639058,5.1Identifiers 17>>

<<_Toc92639059,5.2Acronyms 17>>

<<_Toc92639060,6.Requirements Classes 18>>

<<_Toc92639061,1.1Requirements Class "Core" 19>>

<<_Toc92639062,1.1.1Landing page 20>>

<<_Toc92639063,1.1.2Declaration of Conformance Classes 22>>

<<_Toc92639064,1.1.3API Definition 23>>

<<_Toc92639065,1.1.4Collections 25>>

<<_Toc92639066,1.1.53D-Container 26>>

<<_Toc92639067,1.2Requirements Class "Extension" 30>>

<<_Toc92639068,1.2.1Requirements Class "spatial query extension" 32>>

<<_Toc92639069,7.Media Types for any data encoding(s) 35>>

<<_Toc92639070,7.1application/json+i3s 35>>

<<_Toc92639071,7.2application/json+3dtiles 36>>

<<_Toc92639072,Annex A: Conformance Class Abstract Test Suite (Normative) 38>>

<<_Toc92639073,A.1Test Case 1 38>>

<<_Toc92639074,A.2Test Case 2 39>>

+
 +

<<_Toc92639075,Annex B: Web API (Normative) 40>>

<<_Toc92639076,HTTP 1.1 40>>

<<_Toc92639077,HTTP status codes 40>>

<<_Toc92639078,Unknown or invalid query parameters 42>>

<<_Toc92639079,Web caching 43>>

<<_Toc92639080,Support for cross-origin requests 43>>

+
 +

<<_Toc92639081,Annex C: Data Architecture (Informative) 44>>

<<_Toc92639082,GeoVolumes (3D-Container) 45>>

<<_Toc92639083,Bounding Volume 47>>

<<_Toc92639084,Coordinate Reference System (CRS) 49>>

<<_Toc92639085,Extent 49>>

<<_Toc92639086,Link 50>>

<<_Toc92639087,Link Relation Type (Rel) 50>>

<<_Toc92639088,Spatial Extent 51>>

<<_Toc92639089,Temporal Extent 52>>

<<_Toc92639090,TRS 53>>

<<_Toc92639091,Content Type 53>>

+
 +

<<_Toc92639092,Annex D: Example Responses (Informative) 54>>

+
 +

<<_Toc92639093,Annex E: Accessing 3D Content by Tile Coordinates (Informative) 57>>

+
 +

<<_Toc92639094,Annex F: Revision History 58>>

+
 +

+
 +

+
 +

*List of Figures*

[[Table of Figures1]]

<<_Toc92696351,Figure 1 - GeoVolumes API allows access to 3D content from different providers 9>>

+
 +

<<_Toc92696352,Figure 2 - Bounding Volumes (Box, Region, Sphere) with enclosed cuboid objects 10>>

+
 +

<<_Toc92696353,Figure 3 - GeoVolumes in nested hierarchy with 3D dataset and multiple distributions 11>>

+
 +

<<_Toc92696354,Figure 4 - GeoVolumes reference extent of datasets and link to 'child' GeoVolumes 12>>

+
 +

<<_Toc92696355,Figure 5 - GeoVolumes&nbsp;may optionally&nbsp;access 3D&nbsp;content&nbsp;via tile coordinates 13>>

+
 +

<<_Toc92696356,Figure 6 - Basic architecture of server components to access 3D GeoVolumes 13>>

+
 +

<<_Toc92696357,Figure 7 - UML diagram of a 3D-Container (GeoVolume) 30>>

+
 +

+
 +

+
 +

+
 +

+
 +

[type=i]
. *Abstract*

This document provides an Application Programming Interface (API) and encoding that organizes access to a variety of 2D / 3D content according to a hierarchy of 3D geospatial volumes (GeoVolumes). The goal of this specification is to establish an API and encoding that allows applications to request a variety of 3D content from different providers in an interoperable and standardized way.

image::images/001.gif[Shape1] The API described in this document is based on Open Geospatial Consortium (OGC) and OpenAPI principles. The API is consistent with OGC API - Common core building blocks and supports link-follow, bounding box and tile coordinate query methods of access to resources of interest.

An OGC API - 3D GeoVolumes specification is needed because a variety of solutions and standards exist to access and transfer 3D geospatial content (e.g. 3D Tiles, I3S, glTF and others). The OGC API - 3D GeoVolumes specification addresses this challenge by providing a resource model and corresponding API to integrate various approaches to accessing and transferring 2D / 3D geospatial content into a single, open standards-based solution. By outlining an implementation approach for the parameters of the API, the 3D GeoVolumes specification simplifies application development across geospatial enterprises by providing a single interface for requesting and receiving a variety of 2D / 3D datasets and their distribution. As such, the goal of this OGC API specification is not to replace existing distribution methods and models for 3D content, but to enable interoperability between them.

The content provided within this document is derived largely from work done during collaborative, hands-on engineering conducted by members of the OGC during late 2019 and early 2020. As additional methodologies mature, this OGC API will be updated to include those approaches.

[start=2,type=i]
. *Keywords*

The following are keywords to be used by search engines and document catalogues.

OGC API, 3D Tiles , I3S, geographic information, Geospatial API, GeoVolume, GeoVolumes, 3D, feature, geographic information, dataset, distribution, API, OpenAPI, HTML, glTF, bounding volume hierarchy

[start=3,type=i]
. *Preface*

Attention is drawn to the possibility that some of the elements of this document may be the subject of patent rights. The OGC shall not be held responsible for identifying any or all such patent rights.

Recipients of this document are requested to submit, with their comments, notification of any relevant patent claims or other intellectual property rights of which they may be aware that might be infringed by any implementation of the standard set forth in this document, and to provide supporting documentation.

[start=4,type=i]
. *Security Considerations*

No security considerations have been made for this Standard

[start=5,type=i]
. *Submitting organizations*

The following organizations are submitting this document to the OGC:

* Army Geospatial Center (AGC)
* Cesium
* Cognitics
* Ecere
* Helyx
* Skymantics
* Strategic Alliance Consulting Inc.
* Steinbeis

+

[start=6,type=i]
. *Submitters*

All questions regarding this submission should be directed to the editor or the submitters:

[width=531]
|===
h| Name h| Affiliation
| Jeff Harrison, Editor | Army Geospatial Center (AGC)
| Ignacio Correas, Editor | Skymantics
| Jerome Jacovella-St-Louis, Editor | Ecere
| Tom Boggess | Strategic Alliance Consulting Inc.
| Volker Coors | Steinbeis
| Ryan Gauthier | Army Geospatial Center
| Anneley Hadland | Helyx
| Michala Hill | Cognitics
| Thomas Myers | Strategic Alliance Consulting Inc.
| Amy Youmans | Army Geospatial Center (AGC)
| Insert POC Here | Cesium

|===

. 
== Scope

The OGC 3D GeoVolumes specification provides an Application Programming Interface (API) and encoding that organizes access to a variety of 3D content according to a hierarchy of 3D geospatial volumes (GeoVolumes).

The goal of this OGC API is to allow applications to request a variety of 3D content from different providers in an interoperable and standardized way.

image::images/002.gif[Shape2] OGC API - 3D GeoVolumes specification is based on Open Geospatial Consortium (OGC) and OpenAPI principles. The API is consistent with OGC API – Common – Part 1: Core building blocks and supports link-follow, bounding box query, and tile coordinate methods of access to resources of interest.

The objective of the 3D GeoVolumes API and resource model is not to replace existing distribution methods and models for 3D content such as OGC 3D Tiles and I3S, but to enable interoperability between them.

The content provided within this document is derived largely from work done during collaborative, hands-on engineering conducted by members of the OGC during late 2019 and early 2020.

+
 +

.. 
=== Why 3D GeoVolumes

+
 +

OGC API - 3D GeoVolumes is needed because a variety of solutions and standards exist to access and transfer 3D geospatial content (e.g. 3D Tiles, I3S, glTF and others). OGC API - 3D GeoVolumes addresses the challenge of accessing and transferring 3D geospatial content in a variety of standards by providing a resource model and single API for requesting, receiving, and distributing this content, thus simplifying application development across geospatial enterprises. The 3D GeoVolumes API and resource model use a space-centric perspective to allow efficient access to 3D content.

This OGC API is not intended to replace existing distribution methods and models for 3D content, but to enable interoperability between them.

A high-level representation of a geospatial enterprise implementing 3D GeoVolumes based on the needs of various types of entities and/or systems ('A'), ('B'), and ('C') is illustrated in the figure below. The demonstration scenario involves siting a field hospital in Central Park, New York City during a global pandemic.

+
 +

image::images/003.png["",638,322]

*Figure 1 - The GeoVolumes API allows access to a variety of 3D content from different providers in a standardized way*

+
 +

The three systems differ in the 3D content standards implemented, volume of data that can be stored and processed, supported analytics and available bandwidth for data transport between entities, with 'A' having the highest bandwidth and 'C' having the lowest bandwidth.

+

Despite these differences, 3D GeoVolumes provides a model that allows offering, discovering, requesting and accessing data at each entity using a common API on top of a single organizational model of 3D geospatial resources. This common API leverages available 3D geospatial data formats and distribution standards such as 3D Tiles [https://www.ogc.org/standards/3DTiles[https://www.ogc.org/standards/3DTiles]], I3S [https://www.ogc.org/standards/i3s[https://www.ogc.org/standards/i3s]], CityGML [https://www.ogc.org/standards/citygml[https://www.ogc.org/standards/citygml]], and CDB [https://www.ogc.org/standards/cdb[https://www.ogc.org/standards/cdb]] to ensure users can work with 3D geospatial content in the optimal distribution format and interaction method for their application task. High bandwidth capacity data centers ('A') have 3D content available for broad regions or on a global scale. Content can be made available in multiple datasets and distributions based on conversion and transcoding workflows. Access to the data can be offered to other entities in the enterprise by means of the 3D GeoVolumes API. Depending on users' needs, data can be made available through alternative API methods in 2D or in raw format, such as the draft OGC API - Tiles specification or the OGC API - Features Standard.

+

Medium bandwidth capacity data centers ('B') do not require all data that is available at the data center ('A') but are more selective according to their role. The amount of data transferred to ('B') depends on the available bandwidth and specific needs for data analysis and re-distribution. To obtain required data in the best suited format and minimum size, medium bandwidth capacity data centers make use of the specific space-centric indexing scheme that is the fundamental idea of a GeoVolume resource and the corresponding 3D GeoVolumes API offered by ('A').

The high-level architecture defines a third enterprise entity, low bandwidth capacity field operations ('C'). These are connected at various bandwidths including intermittently connected or completely offline situations. In these cases, offline data packaging mechanisms and data volume are operational considerations and optimized data selection and transmission processes are essential. Customers at this level want to go back and forth between 3D geospatial content distributions optimized for visualization via low bandwidth connections and attribute-loaded data that provides detailed information about selected elements in each view.

+
 +

[start=2]
.. 
=== What are 3D GeoVolumes

+
 +

The previous section provided a high-level representation of a geospatial enterprise implementation of the 3D GeoVolumes API based on the needs of various types of entities and/or systems. The technology described in this API supports this scenario efficiently because 3D GeoVolumes follow a common conceptual organization of space applied by humans, which is a collection of spaces where the spaces contain either sub-spaces or a set of objects. This representation of space is called the Bounding Volume, which is a closed volume containing the union of a set of geometric objects. The figure below illustrates typical Bounding Volumes (Box, Region, Sphere) with enclosed cuboid objects.

image::images/004.png["",666,205]

*Figure 2 - Bounding Volumes (Box, Region, Sphere) with enclosed cuboid objects*

+
 +

The space organized in this manner may describe a collection of disjoint GeoVolumes, hierarchical collections of GeoVolumes or GeoVolumes accessed by tile coordinates organized in an OGC tiling scheme. The concepts of disjoint and hierarchical collections of GeoVolumes are illustrated in the figure below where the GeoVolume "North America" contains two child GeoVolumes "Montreal" and "New York City". &nbsp;Both are spatially disjoint. The GeoVolume "New York City" contains a single 3D Dataset representing buildings. These buildings are available in multiple distribution formats (3D Tiles, I3S and CityGML).

+
 +

image::images/005.png["",389,470]

*Figure 3 - GeoVolumes in nested hierarchy with a 3D dataset and multiple distributions*

+
 +

[[_Hlk70424011]]In these constructs, each GeoVolume may have one or more children whose extents may themselves overlap but in aggregate are completely contained in the parent volume extent. Each GeoVolume can contain references to and descriptions of the extent of dataset(s) of its contents and may provide links to multiple distributions of that dataset in different formats or encodings, e.g. 3D Tiles, I3S. GeoVolumes in this model may be accessed as /collections by an API. This API standard does not identify mandatory requirements for how specific distribution formats or encodings are composed and organized into spatial data structures (e.g. tiling schemes).

+
 +

image::images/006.png["",666,459]

*Figure 4 - GeoVolumes can reference extent of datasets and link to 'child' GeoVolumes*

+
 +

A GeoVolumes&nbsp;API may optionally&nbsp;access 3D&nbsp;geospatial content&nbsp;as tiles&nbsp;through extensions for tile coordinates. This may be achieved by using an&nbsp;extraDimensions&nbsp;property consisting of a list of identified objects, each with a description on how the additional dimensions are tiled. It may also be achieved by using Implicit Tiling as outlined in the emerging Community Standard for "3D Tiles Next". The two approaches will be harmonized in the GeoVolumes SWG and this specification updated.

If an&nbsp;extraDimensions&nbsp;property consisting of a list of identified objects is used this information can be added to either a&nbsp;TileMatrixSet's&nbsp;TileMatrix&nbsp;or to a&nbsp;TileSet's TileMatrixSetLimit. Including this property in the&nbsp;TileSet'sTileMatrixSetLimits&nbsp;allows for the re-use of common 2D&nbsp;TileMatrixSets&nbsp;for 3D geospatial content.

+
 +

image::images/007.gif["",576,190]

*Figure 5 - GeoVolumes&nbsp;may optionally&nbsp;access 3D&nbsp;geospatial content&nbsp;via tile coordinates*

+
 +

The default representations of a GeoVolume are json/html information documents that define the bounding box/volume, link to an implicit tileset scheme if applicable, and provide links to the actual content. GeoVolumes are organized in collections as described above.

The basic architecture of server components to access 3D GeoVolume encodings is shown in the figure below. Each 3D / Globe client component can access 3D datasets in multiple distribution formats by means of components implementing the GeoVolumes API as an access interface. The API enables access to these resources using the HTTP protocol and its associated methods.

image::images/008.png["",564,358]

*Figure 6 - Basic architecture of server components to access 3D GeoVolumes*

Clients then visualize the returned content in the context of a 3D globe rendering either built into the client or assembled onto 2D tiles fetched separately from the GeoVolumes API, using for example, a 2D Tile Server. In the future, 2D tiles could also be accessed through the GeoVolumes API.

+
 +

[start=2]
. 
== Conformance

Conformance with this API shall be checked using the tests specified in&nbsp;Annex A of this document. The framework, concepts, and methodology for testing, and the criteria to claim conformance are specified in the&nbsp; https://portal.ogc.org/files/?artifact_id=55234[OGC Compliance Testing Policies and Procedures]&nbsp;and the&nbsp; https://www.ogc.org/compliance[OGC Compliance Testing]&nbsp;web site.

+

The one Standardization Target for this standard is&nbsp; https://docs.ogc.org/is/19-086r4/19-086r4.html#webapi-definition[Web APIs].

+

https://docs.ogc.org/is/19-086r4/19-086r4.html#OGC19-072[OGC API - Common - Part 1: Core]&nbsp;defines an API module intended for re-use by other OGC Web API standards. The OGC API - 3D GeoVolumes is an extension of&nbsp; https://docs.ogc.org/is/19-086r4/19-086r4.html#OGC19-072[OGC API - Common - Part 1: Core]. Conformance to the OGC API - 3D GeoVolumes requires demonstrated conformance to the applicable Conformance Classes of OGC API - Common.

+

OGC API - 3D GeoVolumes identifies a set of Conformance Classes. The&nbsp; https://docs.ogc.org/is/19-086r4/19-086r4.html#ctc-definition[Conformance Classes]&nbsp;implemented by an API are advertised through the&nbsp;/conformance&nbsp;path on the landing page.

+

Each Conformance Class is defined by one or more&nbsp; https://docs.ogc.org/is/19-086r4/19-086r4.html#requirements-class-definition[Requirements Classes] defined in Section 6. The requirements in Section 6&nbsp;are organized by Requirements Class.

+
 +

.. 
=== Mandatory Requirements Classes

The mandatory requirements class of OGC API - 3D GeoVolumes is the Requirements Class "OGC API – 3D GeoVolumes – Core" specified in Section 6.

This requirements class inherits from the&nbsp;_Core Requirements Class_&nbsp;of&nbsp; https://docs.ogc.org/is/19-086r4/19-086r4.html#OGC19-072[OGC API — Common — Part 1: Core]&nbsp;which specifies the minimal useful service interface for an OGC API.

*The requirements specified in the&nbsp;Requirements Class "OGC API – 3D GeoVolumes – Core"&nbsp;focus on minimal capabilities for a static web server.*

The requirements specified in the&nbsp;Requirements Class "OGC API – 3D GeoVolumes – Core"&nbsp;are mandatory for all implementations of the 3D GeoVolumes API.

+
 +

[start=2]
.. 
=== Optional Requirements Classes

The optional requirements classes of OGC API - 3D GeoVolumes include Requirements Class "OGC API – 3D GeoVolumes – Extension" specified in Section 6.

*The requirements specified in the&nbsp;Requirements Class "OGC API – 3D GeoVolumes – Extension"&nbsp;adds the option for a spatial query parameter or tile coordinates to limit the result.*

The requirements specified in the&nbsp;Requirements Class "OGC API – 3D GeoVolumes – Extension"&nbsp;are optional for implementations of the 3D GeoVolumes API.

+
 +

[start=3]
. 
== References

The following informative documents contain provisions that, through reference in this text, are important to understanding this document. For dated references, subsequent amendments to, or revisions of, any of these publications do not apply. For undated references, the latest edition of the document referred to applies.

[width=575]
|===
h| *Identifier* h| *Title* h| *Version* h| *Date*
| OGC 15-001r4 | _OGC 3D Portrayal Service_ https://docs.opengeospatial.org/is/15-001r4/15-001r4.html[_https://docs.opengeospatial.org/is/15-001r4/15-001r4.html_] | 1.0 | 13SEP2017
| OGC 17-014r7 | _OGC Indexed 3D Scene Layer (I3S) and Scene Layer Package Format Specification_ https://www.ogc.org/standards/i3s[_https://www.ogc.org/standards/i3s_] | 1.1 | 08FEB2020
| OGC 17-046 | _OGC Testbed 13: 3D Tiles and I3S Interoperability and Performance Engineering Report_ http://www.opengis.net/doc/PER/t13-NG002[_http://www.opengis.net/doc/PER/t13-NG002_] | N/A | 5MAR2018
| OGC 17-069r3 | _OGC® API – Features – Part 1: Core_ http://www.opengis.net/doc/IS/ogcapi-features-1/1.0[_http://www.opengis.net/doc/IS/ogcapi-features-1/1.0_] | 1.0 | 14OCT2019
| OGC 18-053r2 | _3D Tiles S__pecification_ _1.0_ https://www.ogc.org/standards/3DTiles[_https://www.ogc.org/standards/3DTiles_] | 1.0 | 31JAN2019
| OGC 19-010r2 | _OGC Testbed-15: Styles API Engineering Report_ http://www.opengis.net/doc/PER/t15-D012[_http://www.opengis.net/doc/PER/t15-D012_] | N/A | 12DEC2019
| OGC 19-041r3 | _OGC Routing Pilot Engineering Report_ http://www.opengis.net/doc/PER/routing-pilot-er[_http://www.opengis.net/doc/PER/routing-pilot-er_] | N/A | 8JAN2020
| OGC 19-069 | _OGC Testbed-15: Maps and Tiles API Engineering Report_ http://www.opengis.net/doc/PER/t15-D014[_http://www.opengis.net/doc/PER/t15-D014_] | N/A | 22NOV2019
| OGC 20-029 | _3D Data Container Engineering Report._ http://www.opengis.net/doc/PER/20-029[_http://www.opengis.net/doc/PER/20-029_] | 1.0 | 15JUL2020
| OGC 20-030 | _OGC® API – Tiles-3D (GeoVolumes) Engineering Report._ http://www.opengis.net/doc/PER/20-030[_http://www.opengis.net/doc/PER/20-030_] | 1.0 | 15JUL2020
| OGC 20-031 | _3D Data Container and Tiles API Pilot Summary Engineering Report_ https://www.opengis.net/doc/PER/20-031[_https://www.opengis.net/doc/PER/20-031_] | 1.0 | 15JUL2020
a| +

| _OpenAPI Specification__https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.0.md_ | 3.0.0 | 16FEB2021
| OGC 19-072 | _OGC® API – Common – Part 1: Core_ http://docs.ogc.org/DRAFTS/19-072.html[_http://docs.ogc.org/DRAFTS/19-072.html_] | 1.0 | 23AUG2021
| OGC 20-024 | _OGC® API – Common – Part 2: Geospatial Data_ http://docs.ogc.org/DRAFTS/20-024.html[_http://docs.ogc.org/DRAFTS/20-024.html_] | 1.0 | 06OCT2021
| OGC 17-083r3 | _OGC® Two Dimensional Tile Matrix Set and Tile Set Metadata Standard_ http://www.ogc.org/standards/requests/240.html[_http://www.ogc.org/standards/requests/240.html_] | 1.0 | 03DEC2021
a| +

| _3D Tiles Next_ https://github.com/CesiumGS/3d-tiles/tree/3d-tiles-next/extensions/3DTILES_implicit_tiling/[_https://github.com/CesiumGS/3d-tiles/tree/3d-tiles-next/extensions/3DTILES_implicit_tiling/_] a| +

a| +

|===

[start=4]
. 
== Terms and Definitions

This document used the terms defined in OGC Policy Directive 49

== ^1^
, which is based on the ISO/IEC Directives, Part 2, Rules for the structure and drafting of International Standards. In particular, the word "shall" (not "must") is the verb form used to indicate a requirement to be strictly followed to conform to this Standard and OGC documents do not use the equivalent phrases in the ISO/IEC Directives, Part 2.

For the purposes of this document, the following additional terms and definitions apply.

+

*bounding volume*

typically, a shape like a sphere, rectangular box, or convex hull that can simply be tested for intersection or overlap.

+

*dataset*

collection of data. (source: ISO 19168-1:2020)

+

+

*distribution*

specific representation of a dataset. (source: ISO 19168-1:2020)

+

*feature*

abstraction of real-world phenomena. (source: ISO 19101-1:2014)

+
 +

+

*geovolume*

a hierarchy of geospatial bounding volumes.

+
 +

+

*static web server*

a computer with an HTTP server containing hosted files that are sent 'as-is' to an application.

+
 +

+

*Web API*

API using an architectural style that is founded on the technologies of the Web. [derived from the W3C Data on the Web Best Practices]

+
 +

[start=5]
. 
== Conventions

This section provides details and examples for conventions used in this document.

+
 +

.. 
=== Identifiers

The normative provisions in this specification are denoted by the URI

http://www.opengis.net/spec/{standard}/{m.n}

All requirements and conformance tests that appear in this document are denoted by partial URIs which are relative to this base.

+
 +

[start=2]
.. 
=== Acronyms

The acronyms relevant to this document are specified in the following list.

* image::images/009.gif[Shape3]API Application Programming Interface
* BBOX Bounding Box
* BVH Bounding Volume Hierarchy
* CDB Common Database
* COTS Commercial Off The Shelf
* CRS Coordinate Reference System
* glTF GL Transmission Format
* HTTP Hypertext TransferProtocol
* JSON JavaScript Object Notations
* OGC Open GeospatialConsortium
* SWG Standards Working Group

+
 +

[start=6]
. 
== Requirements Classes

This section outlines requirements for an implementation of the 3D GeoVolumes API.

In addition to these basic requirements, the following requirements/conformance classes apply:

* *Core: Minimal GeoVolumes API capabilities (static web server)*
* *Extension: Adds the option for a spatial query parameter or tile coordinate to limit the result set.*

+
 +

The 3D GeoVolumes API is designed to be a specialized API based on the OGC API principles that can significantly reduce the burden of implementing new clients and APIs as the specification only requires a minimal set of content/parameters needed to transfer 3D data, features, and attributes through an API.&nbsp;

This 3D GeoVolumes API follows the standards and conventions provided in the OGC API - Common for Web APIs. The 3D GeoVolumes API conforms to the OGC API - Common foundation resources: landing page, API definition, conformance, and collections (spatial resources).

The 3D GeoVolumes APIsupports the resources and operations listed in Table 1 with the associated conformance class and the link to the document section that specifies the requirements.

+
 +

[width=575]
|===
| *Resource* | *Path* | *HTTP Method* | *Description*

| Landing Page | / | GET | The landing page

| Conformance Declaration | /conformance | GET | The conformance information
| API Definition | /api | GET | The API Definition document
| Collections | /collections | GET | Collections
| 3D Container | /collections/{3DContainerId} | GET | 3D-Container

|===

*Table 1 - GeoVolumes API - Overview of resources and applicable HTTP methods*

+
 +

.. 
=== Requirements Class "Core"

All resources are available in a 'Core' requirements class, i.e. all GeoVolumes APIs will support them.
== ^2^

+
 +

[width=100%]
|===
2+.<h| *R**equirements Class*
2+.<| http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/req/core[http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/req/core]
| Target type | Web API
| Dependency | OGC API – Common – Part 1: Core
| Dependency | JSON

|===

+
 +

... 
==== Landing page

+
 +

The entry point to the API (/). The landing page provides links to the service description, API definition (/api), conformance declaration (/conformance) and collections (/collections).

.... 
===== Operation

+
 +

[width=100%]
|===
h| *Requirement 1* h| */req/core/root-op*
| A | The server SHALL support the HTTP GET operation on the URI {root}/.

|===

+
 +

[start=2]
.... 
===== Response

[width=100%]
|===
h| *Requirement 2* h| */req/core/root-success*
| A | A successful execution of the operation SHALL be reported as a response with a HTTP status code&nbsp;200.
| B a| The content of that response SHALL be based upon the schema&nbsp; https://raw.githubusercontent.com/opengeospatial/WFS_FES/master/core/openapi/schemas/landingPage.yaml[landingPage.yaml]&nbsp;and include links to the following resources:
* the API Definition (relation type 'service-desc' or 'service-doc')
* the Conformance Declaration (relation type /conformance&nbsp;(relation type ' http://www.opengis.net/def/rel/ogc/1.0/conformance[http://www.opengis.net/def/rel/ogc/1.0/conformance] ')
* /collections&nbsp;(relation type 'data')

|===

+
 +

+
 +

A sample schema for the landing page of the GeoVolumes API is provided below.

+
 +

type: object

required:

- links

properties:

title:

type: string

example:

description:

type: string

example:

links:

type: array

items:

$ref: link.yaml

+
 +

A sample landing page response document of an GeoVolumes API is provided below.

{

"title": "OGC 3D Pilot",

"description": "A Pilot of an API for GeoVolumes",

"links": [

{

"href": " http://data.example.org/[http://data.example.org/]",

"rel": "service-desc",

"type": "application/json",

"title": "Service Description"

},

{

"href": " http://data.example.org/api[http://data.example.org/api]",

"rel": "service",

"type": "application/json",

"title": "the API definition"

},

{

"href": " http://data.example.org/conformance[http://data.example.org/conformance]",

"rel": "conformance",

"type": "application/json",

"title": "Conformance"

},

{

"href": " http://data.example.org/collections[http://data.example.org/collections]",

"rel": "data",

"type": "application/json",

"title": "Collections"

}

]

}

+
 +

+
 +

[start=3]
.... 
===== Error situations

See&nbsp;HTTP Status Codes in Appendix A - Web API&nbsp;for general guidance.

+
 +

[start=2]
... 
==== Declaration of Conformance Classes

+
 +

The Conformance Declaration states the conformance classes from standards or community specifications, identified by a URI, to which the API conforms. The conformance resource requires no parameters. The HTTP /conformance GET response returns the list of URIs of conformance classes implemented by the server in JSON.

+
 +

.... 
===== Operation

+
 +

[width=100%]
|===
h| *Requirement 3* h| */req/core/conformance-op*
| A | The server SHALL support the HTTP GET operation on the URI &nbsp;/{root}/conformance.
| B | The server SHALL support the HTTP GET operation on all links from the landing page that have the relation type http://www.opengis.net/def/rel/ogc/1.0/conformance[http://www.opengis.net/def/rel/ogc/1.0/conformance].
| C | The responses to all HTTP GET requests issued in A and B server SHALL satisfy requirement */req/core/conformance-success.*
| *Requirement 4* | */req/core/conformance-success*
| A | A successful execution of the operation SHALL be reported as a response with a HTTP status code&nbsp;200.
| B | The content of that response SHALL be based upon the schema&nbsp; https://raw.githubusercontent.com/opengeospatial/WFS_FES/master/core/openapi/schemas/confClasses.yaml[confClasses.yaml]&nbsp;and list all OGC API conformance classes that the API conforms to.

|===

+
 +

[start=2]
.... 
===== Response

+
 +

+

A sample schema for the list of conformance classes is provided below.

+

type: object

required:

- conformsTo

properties:

conformsTo:

type: array

items:

type: string

+
 +

+
 +

The following example of the conformance declaration of a 3D GeoVolumes API was taken from the "OGC API – Tiles - 3D (GeoVolumes) Engineering Report":

{

"conformsTo": [

" http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/core[http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/core]",

" http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/oas30[http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/oas30]",

" http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/json[http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/json]"

]

}

+
 +

+
 +

[start=3]
.... 
===== Error situations

See&nbsp;HTTP Status Codes in Appendix A - Web API&nbsp;for general guidance.

+
 +

[start=3]
... 
==== API Definition

+
 +

The&nbsp;API Definition&nbsp;describes the capabilities of the server that can be used by clients to connect to the server or by development tools to support the implementation of servers and clients. Accessing the&nbsp;API Definition&nbsp;using HTTP GET returns a description of the API.

+
 +

.... 
===== Operation

+
 +

[width=100%]
|===
h| *Requirement 5* h| */req/core/api-definition-op*
| A | The URIs of all API definitions referenced from the landing page SHALL support the HTTP GET method.

|===

+
 +

[width=100%]
|===
h| *Permission 1* h| */req/core/api-definition-uri*
| A | The API definition is metadata about the API and strictly not part of the API itself, but it MAY be hosted as a sub-resource to the base path of the API, for example, at path&nbsp;/api. There is no need to include the path of the API definition in the API definition itself.

|===

Note that multiple API definition formats can be supported.

+
 +

[start=2]
.... 
===== Response

+
 +

[width=100%]
|===
h| *Requirement 6* h| */req/core/api-definition-success*
| A | A GET request to the URI of an API definition linked from the landing page (link relations&nbsp;service-desc&nbsp;or&nbsp;service-doc) with an&nbsp;Accept&nbsp;header with the value of the link property&nbsp;type&nbsp;SHALL return a document consistent with the requested media type.

|===

+
 +

[width=100%]
|===
h| *Recommendation 1* h| */rec/core/api-definition-oas*
| A | A JSON representation of the API definition document SHOULD conform to the&nbsp;OpenAPI Specification 3.0, the document.

|===

+
 +

If the server hosts the API definition under the base path of the API (for example, at path&nbsp;/api, see above), there is no need to include the path of the API definition in the API definition itself.

The idea is that any 3D GeoVolumes API implementation can be used by developers that are familiar with the API definition language(s) supported by the server. The developer may need to learn about 3D data types, etc., but it should not be required to read this specification to access the data via the API.

The following is an example of the API definition.

{

"links": [

{

"href": " http://data.example.org/[http://data.example.org/]",

"rel": "self",

"type": "application/json",

"title": "this document"

},

{

"href": " http://data.example.org/api[http://data.example.org/api]",

"rel": "service",

"type": "application/json",

"title": "the API definition"

},

{

"href": " http://data.example.org/conformance[http://data.example.org/conformance]",

"rel": "conformance",

"type": "application/json",

"title": "conformance classes implemented by this server"

},

{

"href": " http://data.example.org/collections[http://data.example.org/collections]",

"rel": "data",

"type": "application/json",

"title": "Metadata about the collections"

}

]

}

===== +
 +

[start=3]
.... 
===== Error situations

See&nbsp;HTTP Status Codes in Appendix A - Web API&nbsp;for general guidance.

+
 +

[start=4]
... 
==== Collections

+
 +

Collections provides the information to access a collection of GeoVolumes (3D Containers). The collection resources accept the 2D or 3D bounding box (bbox) and format parameter. The resource accepts query or header parameters for the format parameter. The bounding box query parameter lower left: x, y, {z}, and upper right x, y, {z} (z-coordinate is optional) returns GeoVolumes that are within the area. The HTTP /collections GET response returns JSON containing two properties, links (link: URI, type, relationship) and 3D Container.

+
 +

[width=100%]
|===
h| *Requirement 7* h| */req/core/collections-op*
| A | The server SHALL support the HTTP GET operation at the path&nbsp;/collections.

|===

+
 +

[width=100%]
|===
h| *Requirement 8* h| */req/core/collections-success*
| A | A successful execution of the operation SHALL be reported as a response with a HTTP status code&nbsp;200.
| B | The content of that response SHALL conform to the media type stated in the Content-Type header.
| C | The content of that response SHALL conform to the media type stated in the query string.
| D | The content of that response SHALL be constrained by the bbox stated in the query string.
| E a| The content of that response SHALL be based upon the following OpenAPI 3.0 schema:type: objectproperties:links:type: arrayitems:type: objectrequired:- href- relproperties:href:type: stringtitle:type: stringnullable: truerel:type: stringtype:type: stringnullable: truehreflang:type: stringnullable: truecollections:type: arrayitems:$ref: '3dcontainer' +

|===

+
 +

[start=5]
... 
==== 3D-Container

+
 +

The collection resources support access to a 3D-Container with a unique identifier (/collections/{3DContainerId}). The format and bounding box parameters in the collections request can be applied to a specific GeoVolume request. The bbox query on a GeoVolume will apply filtering on the contents within the GeoVolume. The HTTP /collections/{3DContainerId} GET response returns JSON representing the 3D-Container (GeoVolume).

[width=100%]
|===
h| *Requirement 9* h| */req/core/collections/{3DContainerId}-op*
| A | The server SHALL support the HTTP GET operation at the path /collections/{3DContainerId}.

|===

+
 +

[width=100%]
|===
h| *Requirement 10* h| */req/core/collections/{3DContainerId}-success*
| A | A successful execution of the operation SHALL be reported as a response with a HTTP status code&nbsp;200.
| B | The content of that response SHALL conform to the media type stated in the Content-Type header.
| C | The content of that response SHALL conform to the media type stated in the query string.
| D | The content of that response SHALL be constrained by the bbox stated in the query string.
| E a| The content of that response SHALL be based upon the following OpenAPI 3.0 schema:type: objectrequired:- id- extent- linksproperties:id:type: stringtitle:type: stringnullable: truedescription:type: stringnullable: truecollectionType:type: stringdefault: '3d-container'itemType:type: stringdefault: 'unknown'extent:type: objectproperties:spatial:type: objectproperties:bbox:type: arrayminItems: 4maxItems: 6items:type: numbercrs:type: stringdefault:'http://www.opengis.net/def/crs/OGC/1.3/CRS84'temporal:type: objectproperties:interval:type: arraynullable: trueminItems: 1items:type: arrayminItems: 2maxItems: 2items:type: stringformat: date-timenullable: truetrs: type: stringnullable: truedefault:'http://www.opengis.net/def/uom/ISO-8601/0/Gregorian'contentExtent:type: arraynullable: trueitems:type: numberformat: doubleminItems: 4maxItems: 12crs:type: stringdefault: 'http://www.opengis.net/def/crs/OGC/1.3/CRS84'links:type: arrayitems:type: objectrequired:- href- relproperties:href:type: stringtitle:type: stringnullable: truerel:type: stringtype:type: stringnullable: truehreflang:type: stringnullable: truechildren:type: arrayitems:$ref: 3dcontainercontent:type: arrayitems:type: objectrequired:- href- relproperties:href:type: stringtitle:type: stringnullable: truerel:type: stringtype:type: stringnullable: truehreflang:type: stringnullable: true +

|===

+
 +

image::images/010.png["",666,483]

*Figure 7 - UML diagram of a 3D-Container (GeoVolume)*

+
 +

See Table 4 in Appendix B for additional guidance.

+
 +

[start=2]
.. 
=== Requirements Class "Extension"

+
 +

This class provides specifics on the extensions to the Collections requirement class. The extensions to the Collections requirement class are as follows:

+
 +

* The collections path (/collections) is extended by the addition of a bounding box query parameter.
* The collections path (/collections/{3DContainerId}) is extended by the addition of a bounding box query parameter.

+

The resulting API has the resources listed in the Table below:

+
 +

[width=100%]
|===
| *Resource* | *Path* | *HTTP method* | *Changes*

| Landing page | / | GET | None

| Conformance declaration | /conformance | GET | Returns additional conformance classes
| API | /api | GET | API definition
| Collections | /collections?bbox | GET | Bounding Box parameter added.
| 3D Container | /collections/{3DContainerId}?bbox | GET | Bounding Box parameter added.

|===

*Table 2 - Overview of resources and applicable HTTP methods with "bbox" extension*

+
 +

The following is an example of the conformance declaration of a 3D GeoVolumes API that implements all requirement classes:

{

"conformsTo": [

" http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/core[http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/core]",

" http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/oas30[http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/oas30]",

" http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/html[http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/conf/html]",

"http://www.opengis.net/spec/ogcapi-geovolumes-

1/1.0/conf/spatialquery"

]

}

+
 +

+
 +

... 
==== Requirements Class "spatial query extension"

+
 +

The requirement class 'spatialquery' is an extension to the 'Core' requirement class which allows query by spatial and temporal constraints. The server shall return 3D content if any part of the content lies inside the query bbox when querying by spatial constraints.

[[_Hlk54775801]] +
 +

[[_Hlk54774675]] +
 +

[width=100%]
|===
2+.<h| *Requirements Class*
2+.<| http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/req/spatialquery[http://www.opengis.net/spec/ogcapi-geovolumes-1/1.0/req/spatialquery]
| Target type | Web API
| Dependency | http://docs.opengeospatial.org/per/19-040.html#rc_core[Requirements Class "Core"]
| Dependency | JSON

|===

+
 +

[width=100%]
|===
h| *Requirement 11* h| */req/spatialquery/op*
| A | The server SHALL support the HTTP GET operation at the path/collections?bbox for a 3D Container (GeoVolume).

|===

+
 +

[width=100%]
|===
h| *Requirement 12* h| */req/spatialquery/op*
| A | The server SHALL support the HTTP GET operation at the path/collections/{3DContainerId}?bbox for each 3D Container(GeoVolume).

|===

+
 +

[width=100%]
|===
h| *Requirement 13* h| */req/spatialquery/success*
| A | A successful execution of the operation SHALL be reported as aresponse with a HTTP status code 200.
| B a| The content of the response SHALL be based upon the following OpenAPI 3.0 schema:type: objectrequired:- id- extent- linksproperties:id:type: stringtitle:type: stringnullable: truedescription:type: stringnullable: truecollectionType:type: stringdefault: '3d-container'itemType:type: stringdefault: 'unknown'extent:type: objectproperties:spatial:type: objectproperties:bbox:type: arrayminItems: 4maxItems: 6items:type: numbercrs:type: stringdefault:'http://www.opengis.net/def/crs/OGC/1.3/CRS84'temporal:type: objectproperties:interval:type: arraynullable: trueminItems: 1items:type: arrayminItems: 2maxItems: 2items:type: stringformat: datetimenullable: truetrs:type: stringnullable: truedefault:'http://www.opengis.net/def/uom/ISO-8601/0/Gregorian'contentExtent:type: arraynullable: trueitems:type: numberformat: doubleminItems: 4maxItems: 12crs:type: stringdefault:'http://www.opengis.net/def/crs/OGC/1.3/CRS84'links:type: arrayitems:type: objectrequired:- href- relproperties:href:type: stringtitle:type: stringnullable: truerel:type: stringtype:type: stringnullable: truehreflang:type: stringnullable: truechildren:type: arrayitems:$ref: 3dcontainer +
| C | The id member of each spatial query SHALL be unique.

|===

[start=7]
. 
== Media Types for any data encoding(s)

The following media types are applicable to the 3D GeoVolumes API:

* application/json – is the JSON media type used for all content.
* text/html – is the HTML media type for all "web pages" provided by the API.

+

The media types in the following sections are informative to the 3D GeoVolumes API.

.. 
=== application/json+i3s

+
 +

[width=100%]
|===
.<h| *Type name: application**Subtype name: json+i3s*
.<| Required parameters: n/aOptional parameters: n/aEncoding considerations: See RFC 8259, The JavaScript Object Notation (JSON) DataInterchange FormatSecurity considerations: See Section 12 of RFC 8259Interoperability considerations: n/aPublished specification: link: n/aApplications that use this media type: n/aAdditional information:Deprecated alias names for this type: n/aMagic number(s): n/aFile extension(s): .jsonMacintosh file type code(s): n/aPerson to contact for further information: n/aIntended usage: COMMONRestrictions on usage: noneAuthor: n/aChange controller: n/a

|===

+
 +

[start=2]
.. 
=== application/json+3dtiles

+
 +

[width=100%]
|===
.<h| *Type name: application**Subtype name: json+3dtiles*
.<| Required parameters: n/aOptional parameters: n/aEncoding considerations: See RFC 8259, The JavaScript Object Notation (JSON) Data Interchange FormatSecurity considerations: See Section 12 of RFC 8259Interoperability considerations: n/aPublished specification: n/alink: n/aApplications that use this media type:Additional information:Deprecated alias names for this type: n/aMagic number(s): n/aFile extension(s): .jsonMacintosh file type code(s): n/aPerson to contact for further information: n/aIntended usage: COMMONRestrictions on usage: noneAuthor: n/aChange controller: n/a

|===

+
 +

+
 +

+
 +

+
 +

== Annex A: Conformance Class Abstract Test Suite (Normative)

[[_Ref259545760]]*Conformance Class: Core*

+
 +

[width=100%]
|===
.<a| 
[type=A]

.. 
=== Test Case 1
.<| *Requirement(s):* /req/core/collections-op, /req/core/collections-success
.<| *Test purpose:* Verify that the collections resources can be fetched.
.<a| *Test Method:* +
1. Issue an HTTP GET request to the path /collections with header Accept: application/json.2. Issue an HTTP GET request to the path /collections?f=json.3. Issue an HTTP GET request to the path `/collections?bbox=x1,y1,{z1},x2,y2,{z2}.4. Validate that the response has a status code 200.5. Validate the contents of the returned document against the schema in: /collections, item E.6. Verify that each container id #/collections/{i} (where {i} is the index of the style in the array) is unique.7. Verify that each collection has at least one link with rel=self.8. Verify that for each link with rel=self that the href value links to a resource at the path /collections/{3DContainerId} where {3DContainerId} is the id member of the 3d Container.9. If each collection has content greater than one, verify each content contains rel=original or rel=alternate

|===

+

+
 +

[width=100%]
|===
.<a| 
[type=A]

[start=2]
.. 
=== Test Case 2
.<| *Requirement(s):* /req/core/collections/{3DContainerId}-op, /req/core/collections/{3DContainerId}-Success
.<| *Test purpose:* Verify that the 3D Container resources can be fetched.
.<a| *Test Method:* +
1. Issue an HTTP GET request to the path /collections/{3DContainerId} with header Accept: application/json.2. Issue an HTTP GET request to the path /collections/{3DContainerId}?f=json.3. Issue an HTTP GET request to the path `/collections/{3DContainerId}?bbox=x1,y1,{z1},x2,y2,{z2}.4. Validate that the response has a status code 200.5. Validate the contents of the returned document against the schema in: /collections/{3DContainerId}, item E.6. Verify that each container id #/collections/{i} (where {i} is the index of the style in the array) is unique.7. Verify that each collection has at least one link with rel=self.8. Verify that for each link with rel=self that the href value links to a resource at the path /collections/{3DContainerId}9. If each collection has content greater than one, verify each content contains rel=original or rel=alternate

|===

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

== Annex B: Web API (Normative)

=== HTTP 1.1

[width=100%]
|===
h| *Requirement* h| */req/core/http*
| A | The server SHALL conform to&nbsp; http://docs.opengeospatial.org/DRAFTS/17-069r2.html#rfc2616[HTTP 1.1].
| B | If the server supports HTTPS, the server SHALL also conform to&nbsp; http://docs.opengeospatial.org/DRAFTS/17-069r2.html#rfc2818[HTTP over TLS].

|===

This includes the correct use of status codes, headers, etc.

[width=100%]
|===
h| *Recommendation* h| */rec/core/head*
| A | The server SHOULD support the HTTP 1.1 method HEAD for all resources that support the method GET.

|===

Supporting the method HEAD in addition to GET can be useful for clients and is simple to implement.

Servers implementing&nbsp; http://docs.opengeospatial.org/DRAFTS/17-069r2.html#cross_origin[CORS]&nbsp;will implement the method OPTIONS, too.

+
 +

=== HTTP status codes

This API standard does not impose any restrictions on which features of the HTTP and HTTPS protocols may be used. API clients should be prepared to handle any legal HTTP or HTTPS status codeThe&nbsp;*Status Codes*&nbsp;listed in&nbsp;Table 3&nbsp;are of particular relevance to implementers of this standard. Status codes 200, 400, and 404 are called out in API requirements. Therefore, support for these status codes is mandatory for all compliant implementations. The remainder of the status codes in&nbsp;Table 3&nbsp;are not mandatory but are important for the implementation of a well-functioning API. Support for these status codes is strongly encouraged for both client and server implementations.

[width=575]
|===
3+.<| _Typical HTTP status codes_

| Status Code | Mandatory / Optional | Description
| *200* | *Mandatory* | A successful request.

| 304 | Optional | An&nbsp; http://docs.opengeospatial.org/DRAFTS/17-069r2.html#web_caching[entity tag was provided in the request]&nbsp;and the resource has not been changed since the previous request.
| *400* | *Mandatory* | The server cannot or will not process the request due to an apparent client error. For example, a query parameter had an incorrect value.
| 401 | Optional | The request requires user authentication. The response includes a&nbsp;WWW-Authenticate&nbsp;header field containing a challenge applicable to the requested resource.
| 403 | Optional | The server understood the request but is refusing to fulfill it. While status code&nbsp;401&nbsp;indicates missing or bad authentication, status code&nbsp;403&nbsp;indicates that authentication is not the issue, but the client is not authorized to perform the requested operation on the resource.
| *404* | *Mandatory* | The requested resource does not exist on the server. For example, a path parameter had an incorrect value.
| 405 | Optional | The request method is not supported. For example, a POST request was submitted, but the resource only supports GET requests.
| 406 | Optional | The&nbsp;Accept&nbsp;header submitted in the request did not support any of the media types supported by the server for the requested resource.
| 500 | Optional | An internal error occurred in the server.

|===

*Table 3 - Typical HTTP status codes*

More specific guidance is provided for each resource, where applicable.

[width=100%]
|===
h| *Permission 2* h| */per/core/additional-status-codes*
| A | Servers MAY support other capabilities of the HTTP protocol and, therefore, MAY return other status codes than those listed in&nbsp;Table 3.

|===

The API Description Document describes the HTTP status codes generated by that API. This should not be an exhaustive list of all possible status codes. It is not reasonable to expect an API designer to control the use of HTTP status codes which are not generated by their software. Therefore, it is recommended that the API Description Document limit itself to describing HTTP status codes relevant to the proper operation of the API application logic. Client implementations should be prepared to receive HTTP status codes in addition to those described in the API Description Document.

+
 +

=== Unknown or invalid query parameters

[width=100%]
|===
h| *Requirement* h| */req/core/query-param-unknown*
| C | The server SHALL respond with a response with the status code&nbsp;400, if the request URI includes a query parameter that is not specified in the API definition.

|===

If a server wants to support vendor specific parameters, these must be explicitly declared in the API definition.

If OpenAPI is used to represent the API definition, a capability exists to allow additional parameters without explicitly declaring them. That is, parameters that have not been explicitly specified in the API definition for the operation will be ignored.

OpenAPI schema for additional "free-form" query parameters

+

in: query

name: vendorSpecificParameters

schema:

type: object

additionalProperties: true

style: form

Note that the name of the parameter does not matter as the actual query parameters are the names of the object properties. For example, assume that the value of&nbsp;vendorSpecificParameters&nbsp;is this object:

{

"my_first_parameter": "some value",

"my_other_parameter": 42

}

In the request URI this would be expressed

as&nbsp;&my_first_parameter=some%20value&my_other_parameter=42.

[width=100%]
|===
h| *Requirement* h| */req/core/query-param-invalid*
| D | The server SHALL respond with a response with the status code&nbsp;400, if the request URI includes a query parameter that has an invalid value.

|===

This is a general rule that applies to all parameters, whether they are specified in this document or in additional parts. A value is invalid, if it violates the API definition or any other constraint for that parameter stated in a requirement.

=== Web caching

Entity tags are a mechanism for web cache validation and for supporting conditional requests to reduce network traffic. Entity tags are specified by&nbsp; http://docs.opengeospatial.org/DRAFTS/17-069r2.html#rfc2616[HTTP/1.1 (RFC 2616)].

[width=100%]
|===
h| *Recommendation* h| */rec/core/etag*
| A | The service SHOULD support entity tags and the associated headers as specified by HTTP/1.1.

|===

=== Support for cross-origin requests

Access to data from a HTML page is by default prohibited for security reasons if the data is located on another host than the webpage ("same-origin policy"). A typical example is a web-application accessing feature data from multiple distributed datasets.

[width=100%]
|===
h| *Recommendation* h| */rec/core/cross-origin*
| A | If the server is intended to be accessed from the browser, cross-origin requests SHOULD be supported. Note that support can also be added in a proxy layer on top of the server.

|===

Two common mechanisms to support cross-origin requests are:

* https://en.wikipedia.org/wiki/Cross-origin_resource_sharing[Cross-origin resource sharing (CORS)]
* https://en.wikipedia.org/wiki/JSONP[JSONP (JSON with padding)]

+
 +

+
 +

[[_Ref207532345]][[_Ref207532302]][[_Ref207532276]]
=== +
 +

+
 +

+
 +

+
 +

+
 +

== Annex C: Data Architecture (Informative)

[[_Hlk92620786]]The data architecture can be separated into three parts:

1. Common: Landing Page, Conformance Declaration, API Definition

2. GeoVolumes content: Collections, 3D Container

3. Supporting metadata components

[width=100%]
|===
h| *Schemas* h| *Overview*
| Landing Page | OGC API - Common Landing Page
| Conformance | OGC API - Common Conformance Declaration
| API Definition | OGC API - Common API Definition
| Collections | In this specification, 'collection' is used as a synonym for '3d-container collection'.
| 3D Container | Spatial information resource that has a distinct bounding volume containing 3D content.
| Bounding Volume | A closed volume completely containing the union of a set of geometric objects.
| CRS | Coordinate reference system describing coordinates of the extents.
| Exception | An exception describes an event, which occurs during execution that disrupts the normal flow of the program's instructions.
| Extent | The extent of the collection.
| Link | Link to content.
| Spatial Extent | The spatial extent of the element in the collection.
| Temporal Extent | The temporal extent of the element in the collection.
| TRS | Coordinate reference system of the coordinates in the temporal extent.
| Content Type | JSON media type used for content.

|===

+
 +

=== GeoVolumes (3D-Container)

The most general definition of a GeoVolume is a spatial information resource with a distinct bounding volume, a (required) enclosing bounding box (2D / 3D), containing at most one 3D model dataset which is relevant to that volume (items, content) and represented by references to one or more distributions, and includes or references other GeoVolumes (children) whose bounding volumes are fully contained by the parent container's bounding volume. The default representations of a GeoVolume are JSON / HTML information documents which define the bounding box, link to an implicit tileset scheme if applicable, and provide the described sections and links.

This resource is not the same as the collection resource defined in the present draft OGC API - Common but could be considered a specialized type of that collection resource. The collection resource and corresponding collection information document schema were extended in ways that in turn echo the 3D Tiles root node resource (tileset.json). As the definitions of _collections_ and _collection_ evolve with development of OGC API - Common modules, this recommendation may be superseded.

Choices can be made whether to provide a flat list of all GeoVolumes supported by the API instance or only 1-2 top-level or "root" 3D-Container collections which then include child 3D-Containers. The collection information in the collections array may also consist only of the required elements, leaving other elements to be included in the document at the individual collection path.

+
 +

[width=100%]
|===
| *Field Name* | *Required* | *Type* | *Description*

| Id | X | String | Identifier (name) of a specific 3D Container.

| Title a| +

| String | Human readable title of a specific 3D Container.
| description a| +

| String | Detailed description of a specific 3D Container.
| collectionType a| +

| String | Property with value "3d-container" is required.
| itemType a| +

| String | Indicator about the type of the items in the collection (the default value is 'unknown').
| Extent | X | extent | The 3D spatial extent of the container is required.
| contentExtent a| +

| boundingVolume | Optional 3D spatial extent as box, region, or sphere.
| Crs a| +

| crs | Coordinate Reference System
| Links | X a| List of [link] +

| Array members in the "link" property must include "self", and may include "items" (for compatibility with a common collection type), "parent" (link to enclosing 3D-Container), "root" (link to top-level 3D-Container), "scheme" link to the definition of any implicit tile scheme which sets the 3D-Container organization, extent and/or addressing, "affinemap" (link from a 3D-Container with 2D content to a 3D-Container with 2.5D content (surface, point cloud) to which the 2D content should S be texture-mapped).
| Children a| +

| List of [3dcontainer] | A "children" property with an array of zero or more "child" 3D-Containers is required (could be just the required properties: id, self-link,extent).
| content a| +

| List of [link] a| A property with an array of zero or more content references is required. The content of a3D-Container is at most a single dataset (e.g. it may have no content and only children). Each link in the "content" array shall be to a specific distribution of that dataset. The "rel" of each reference indicates its relation to the dataset, such as "original" (the distribution representing the most original version of the dataset, e.g. a CityGML model), or "alternate"(other dataset distributions in different encodings or for different platforms).What a content reference links to is dependent on content type and TBD for some types:
* 3DTiles: tileset.json
* I3S: NodeIndexDocument
* CityGML: Collection document and/or logical space feature (CityModel)
* CDB: Root folder
* 2D features: link to collection information document

|===

*Table 4 - GeoVolume (3D-Container)*

=== Bounding Volume

A bounding volume for a set of objects is a closed volume that completely contains the union of the objects in the set.

Exactly one box, region, or sphere property is required. See 3D-Tiles Bounding volumes [http://docs.opengeospatial.org/cs/18-053r2/18-053r2.html%2331[http://docs.opengeospatial.org/cs/18-053r2/18-053r2.html#31]]

+
 +

[width=100%]
|===
| *Field Name* | *Required* | *Type* | *Description*

| Box | X a| List of [double] +

| An array of 12 numbers that define an oriented bounding box. The first three elements define the x, y, and z values for the center of the box. The next three elements (with indices 3, 4, and 5) define the x-axis direction and half-length. The next three elements (indices 6, 7, and 8) define the y-axis direction and half-length. The last three elements (indices 9, 10, and 11) define the z-axis direction and half-length.

| region a| +

a| List of [double] +

| An array of six numbers that define a bounding geographic region in EPSG:4979 coordinates with the order [west, south, east, north, minimum height, maximum height]. Longitudes and latitudes are in radians, and heights are in meters above (or below) the WGS84 ellipsoid.
| sphere a| +

a| List of [double] +

| An array of four numbers that define a bounding sphere. The first three elements define the x, y, and z values for the center of the sphere. The last element (with index 3) defines the radius in meters.

|===

*Table 5 - Bounding Volume*

+
 +

[width=100%]
|===
h| image::images/011.jpg["",208,208]Figure 6. Bounding box h| Bounding Box YAML:box:type: arrayitems:type: numberformat: doubleminItems: 12maxItems: 12
| image::images/012.jpg["",208,208]Figure 7. Bounding Region | Bounding Region YAML:box:type: arrayitems:type: numberformat: doubleminItems: 6maxItems: 6
| image::images/013.jpg["",208,208]Figure 8. Bounding Sphere | Bounding Sphere YAML:box:type: arrayitems:type: numberformat: doubleminItems: 4maxItems: 4

|===

+
 +

+
 +

=== Coordinate Reference System (CRS)

This is the CRS of the coordinates in the spatial extent (property 'bbox'). The default reference system is EPSG:4979 / WGS 84 longitude/latitude/height [http://www.opengis.net/def/crs/OGC/0/CRS84h[http://www.opengis.net/def/crs/OGC/0/CRS84h]]. In the Core this is the only supported CRS. Extensions may support additional coordinate reference systems and add additional enum values.

+
 +

=== Extent

This is the extent of the 3D GeoVolume. In the Core only spatial and temporal extents are specified. Extensions may add additional members to represent other extents, for example, thermal or pressure ranges. It is recommended that the spatial extent be expressed in CRS84 except if this is not possible.

[width=100%]
|===
| *Field Name* | *Required* | *Type* | *Description*

| extent a| +

a| spatialExtent +

a| +

| temporal a| +

| temporalExtent a| +

|===

*Table 6 - Extent*

=== Link

Link to content.

[width=100%]
|===
| *Field Name* | *Required* | *Type* | *Description*

| href | X | String | The URI of the link

| title a| +

| String a| +
| rel a| +

| rel | Link Relationship
| Type a| +

| type a| +
| Hreflang a| +

| String a| +

|===

*Table 7 - Link*

+
 +

=== Link Relation Type (Rel)

This defines the relationship between the current JSON resource representation and a related JSON resource. For more information see:

* Link Relations [http://docs.opengeospatial.org/is/17-069r3/17-069r3.html%23_link_relations[http://docs.opengeospatial.org/is/17-069r3/17-069r3.html#_link_relations]]
* IANA: Link Relation Types [https://www.iana.org/assignments/link-relations/link-relations.xml[https://www.iana.org/assignments/link-relations/link-relations.xml]]

+
 +

The following enumeration is provided as an example. Other relationship types are possible.

* affinemap: Link from a 3D-Container with 2D content to a 3D-Container with 2.5D content (surface, point cloud) to which the 2D content should be texture-mapped.
* alternate: Refers to a substitute for this context.
* collections: The target points to a 3D-container resource which represents the collection resource for the context.
* conformance: Refers to a resource that identifies the specifications that the link's context conforms to.
* data: Indicates that the link's context is a distribution of a dataset that is an API and refers to the root resource of the dataset in the API.
* dataset: Indicates that the link's context is a distribution of a dataset that is an API and refers to the root resource of the dataset in the API.
* describedby: Refers to a resource providing information about the link's context.
* distribution: Indicates that the link's context is a distribution.
* item: The target IRI points to a resource that is a member of the collection represented by the context IRI.
* items: Refers to a resource that is comprised of members of the collection represented by the link's context.
* original: The distribution representing the most original version of the dataset, e.g. a CityGML model.
* parent: link to enclosing 3D-Container.
* root: link to top-level 3D-Container.
* scheme: link to the definition of any implicit tile scheme which sets the 3D-Container organization, extent and/or addressing.
* self: Conveys an identifier for the link's context.
* service: Indicates a URI that can be used to retrieve a service document.
* service-desc: Identifies service description for the context that is primarily intended for consumption by machines.

+

=== Spatial Extent

This defines the spatial extent of the element in the collection.

[width=100%]
|===
| *Field Name* | *Required* | *Type* | *Description*

| bbox | X | List of [array] | One or more bounding boxes that describe the spatial extent of the dataset (the start and end). The value 'null' is supported and indicates an open time interval. In the Core only a single time interval is supported. In the Core only a single bounding box is supported. Extensions may support additional areas. If multiple areas are provided, the union of the bounding boxes describes the spatial extent.

| crs a| +

| crs | Coordinate reference system of the coordinates in the spatial extent (property bbox). The default reference system is WGS 84 longitude/latitude. In the Core this is the only supported coordinate reference system. Extensions may support additional coordinate reference systems and add additional enum values.

|===

*Table 8 - Spatial Extent*

=== Temporal Extent

This defines the temporal extent of the element in the collection.

+
 +

[width=100%]
|===
| *Field Name* | *Required* | *Type* | *Description*

| interval a| +

a| Array of Strings [date-time] +
Date-time EX: 2011-11-11T12:22:11Z
| One, or more, time intervals that describe the temporal extent of the dataset. The value 'null' is supported and indicates an open time interval. In the Core only a single time interval is supported. Extensions may support multiple intervals. If multiple intervals are provided, the union of the intervals describes the temporal extent.

| trs a| +

| String | Temporal coordinate reference system of the coordinates in the temporal extent (property interval). The default reference system is the Gregorian calendar. In the Core this is the only supported temporal reference system. Extensions may support additional temporal reference systems and add additional enum values.

|===

*Table 9 - Temporal Extent*

+
 +

=== TRS

This defines the coordinate reference system of the coordinates in the temporal extent (property 'interval'). The default reference system is the Gregorian calendar. In the Core this is the only supported temporal reference system. Extensions may support additional temporal reference systems and add additional values.

• http://www.opengis.net/def/uom/ISO-8601/0/Gregorian[http://www.opengis.net/def/uom/ISO-8601/0/Gregorian]

+
 +

=== Content Type

Content type enumeration examples:

• application/json

• application/json+3dtiles

• application/json+i3s

• text/html

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

== +
 +

== +
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

== Annex D: Example Responses (Informative)

This section provides examples of how servers may respond to requests issued by using the GeoVolumes API.

Example 1: The server responds with only one GeoVolume from the container ID ("NewYork/NewYork-buildings"). The container can contain multiple 3D Containers, with multiple formats, and with a flat or hierarchical organization.

{

"id": "NewYork/NewYork-buildings",

"title": "NYC - 3D Buildings Manhattan",

"description": "3D Buildings in Manhattan, New York.",

"collectionType": "3d-container",

"extent": {

"spatial": [

-74.01900887327089,

40.700475291581974,

-11.892070104139751,

-73.9068954348699,

40.880256294183646,

547.7591871983744

],

"crs": " http://www.opengis.net/def/crs/OGC/0/CRS84h[http://www.opengis.net/def/crs/OGC/0/CRS84h]"

},

"links": [

{

"rel": "self",

"href": " http://example.org/collections/NewYork/NewYork-buildings/[http://example.org/collections/NewYork/NewYork-buildings/]",

"type": "application/json",

"title": "NYC - 3D Buildings Manhattan"

},

{

"rel": "items",

"href": "http://example.org/collections/NewYork/NewYork-buildings/i3s/

",

"type": "application/json+i3s",

"title": "NYC - 3D Buildings Manhattan: i3s"

},

{

"rel": "items",

"href": "http://example.org/collections/NewYork/NewYorkbuildings/

3dTiles/",

"type": "application/json+3dtiles",

"title": "NYC - 3D Buildings Manhattan: 3D Tiles"

}

],

"content": [

{

"title": "NYC - 3D Buildings Manhattan: i3s",

"rel": "original",

"href": "http://example.org/collections/NewYork/NewYork-buildings/i3s/

",

"type": "application/json+i3s",

"collectionType": "3d-container"

},

{

"title": "NYC - 3D Buildings Manhattan: 3D Tiles",

"rel": "original",

"href": " http://example.org/NewYork/NewYork-buildings/3dTiles/[http://example.org/NewYork/NewYork-buildings/3dTiles/]",

"type": "application/json+3dtiles",

"collectionType": "3d-container"

}

]

}

+
 +

Example 2: The client parses the 3D Container for 3D Tiles link. Client 3D Tiles/tileset. Response. The server response with tileset.json.

{

"asset": {

"version": "1.0",

"extras": {

"ion": {

"georeferenced": true,

"movable": false

}

}

},

"properties": {

"Height": {

"maximum": 547.7591871983744,

"minimum": -11.892070104139751

},

"Latitude": {

"maximum": 40.880256294183646,

"minimum": 40.700475291581974

},

"Longitude": {

"maximum": -73.9068954348699,

"minimum": -74.01900887327089

}

},

"geometricError": 740.0197559011849,

"root": {

"boundingVolume": {

"region": [

-1.29187544264487,

0.7103573144863446,

-1.289919109210917,

0.7134950819190251,

0,

547.6909683533274

]

},

"geometricError": 740.0197559011849,

"refine": "ADD",

"children": []

}

}

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

+
 +

== Annex E: Accessing 3D Content by Tile Coordinates (Informative)

This informative annex proposes approaches for extending TileMatrixSets and TileSet metadata and using Implicit Tiling for indexing and accessing 3D content as tiles and using a web API is used.

+
 +

EXPAND

== Annex F: Revision History

+
 +

[width=570]
|===
h| Date h| Release h| Author h| Paragraph modified h| Description
a| +

a| +

a| +

a| +

a| +
a| +

a| +

a| +

a| +

a| +
a| +

a| +

a| +

a| +

a| +

|===

+
 +

+
 +

+
 +

[[sdfootnote1]]

[[sdfootnote1sym]] https://portal.ogc.org/public_ogc/directives/directives.php[https://portal.ogc.org/public_ogc/directives/directives.php]

[[sdfootnote2]]

[[sdfootnote2sym]] Check the section numbering in these sections.

46

Copyright © 2022Open Geospatial Consortium

